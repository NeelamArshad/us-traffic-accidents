---
title: "Model"
format: html
execute: 
  echo: false
  warning: false
---

To understand the factors contributing to the severity of traffic accidents in the United States, I fit a linear regression model using a sample of 2 million accident records from the US Accidents dataset (2016â€“2023).

The response variable was Severity, which ranges from 1 (least severe) to 4 (most severe). The predictors included:

Start Time: The time of day when the accident began

Distance: The distance the accident covered, in miles

Weather Condition: The reported weather at the time of the accident

```{r}
#| message: false
#| results: hide
library(arrow)
library(dplyr)
library(ggplot2)
library(vroom)
library(tidyverse)
library(tidymodels)
library(lubridate)
library(knitr)
library(broom)     
library(gt)                
library(broom)          
library(marginaleffects) 
library(easystats) 
file_path2 <- file.path("C:", "Users", "Dell", "Downloads", "US_Accidents_March23.csv")
us_accidents2 <- vroom(file_path2, n_max = 2000000)
```

```{r}
us_accidents_small2 <- us_accidents2[1:2000000, c("Severity", "Start_Time", "Distance(mi)", "Weather_Condition")]
```

```{r}
#| message: false
#| results: hide
linear_reg() |>
  fit(Severity ~ Start_Time + `Distance(mi)` + Weather_Condition, data = us_accidents_small2)
```

## Data Generating Mechanism
The fitted equation, simplified to highlight key relationships, is:

$$
\widehat{\text{Severity}} = 3.493 
- 7.003 \times 10^{-10} \cdot \text{Start_Time} 
+ 0.0415 \cdot \text{Distance (mi)} 
- 0.1003 \cdot \text{Weather_ConditionClear} 
- 0.1780 \cdot \text{Weather_ConditionFog} 
+ 0.0118 \cdot \text{Weather_ConditionLight Snow } 
+ 0.0305 \cdot \text{Weather_ConditionHeavy Rain}
$$

The model includes over 100 levels of `Weather_Condition`, represented as dummy variables. Only a subset is shown here.

```{r}
#| message: false
#| results: hide
fit_cs <- linear_reg() |>
  fit(Severity ~ Start_Time + `Distance(mi)` + Weather_Condition, data = us_accidents_small2)

plot_predictions(fit_cs, by = c("Severity", "Start_Time", "Distance(mi)", "Weather_Condition"), draw = FALSE)
```

### Estimated Model Coefficients

| Variable              | Estimate  |
|-----------------------|-----------|
| Intercept             | 3.493     |
| Start_Time            | -7.0e-10  |
| Distance (mi)         | 0.0415    |
| Weather: Rain         | 0.023     |
| Weather: Snow         | 0.038     |
| Weather: Fog          | -0.178    |
| Weather: Clear        | -0.100    |
| Weather: Haze         | -0.038    |
| Weather: Mist         | -0.128    |
| Weather: Light Snow   | 0.012     |
| Weather: Thunderstorm | -0.084    |
| Weather: Tornado      | -1.334    |
| ...                   | ...       |

*Only selected variables shown; full model includes 100+ weather conditions as dummies.*


This model suggests that:

Accidents covering longer distances are associated with slightly higher severity.
Accidents occurring during snow or heavy rain conditions tend to be more severe than those during clear weather. Start_Time has a very small, but technically nonzero, effect on severity.
Weather conditions such as "Clear" and "Overcast" are associated with lower severity, while conditions like "Snow" and "Heavy Rain" are linked to increased severity, relative to the reference weather category.
